"use strict";(globalThis.webpackChunkportfolio_edu_lab=globalThis.webpackChunkportfolio_edu_lab||[]).push([[4726],{7876(s,e,n){n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>o,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"edulab-synthesis-engine/hardware-design","title":"Hardware Design","description":"Technical documentation of the current hardware implementation.","source":"@site/docs/edulab-synthesis-engine/hardware-design.md","sourceDirName":"edulab-synthesis-engine","slug":"/edulab-synthesis-engine/hardware-design","permalink":"/portfolio_eduLAB/projects/edulab-synthesis-engine/hardware-design","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Hardware Design"},"sidebar":"projectsSidebar","previous":{"title":"eduLAB Synthesis Engine","permalink":"/portfolio_eduLAB/projects/edulab-synthesis-engine/intro"},"next":{"title":"Software Architecture","permalink":"/portfolio_eduLAB/projects/edulab-synthesis-engine/software-architecture"}}');var r=n(4848),l=n(8453);const a={sidebar_position:2,title:"Hardware Design"},t="Hardware Design \u2014 v3.8",d={},c=[{value:"1. What This Page Documents",id:"1-what-this-page-documents",level:2},{value:"2. Design Philosophy: Low-Level Physics First",id:"2-design-philosophy-low-level-physics-first",level:2},{value:"3. System Overview",id:"3-system-overview",level:2},{value:"4. The Complete Schematic",id:"4-the-complete-schematic",level:2},{value:"5. How to Read the Schematic",id:"5-how-to-read-the-schematic",level:2},{value:"6. Power Supply",id:"6-power-supply",level:2},{value:"7. The Microcontroller",id:"7-the-microcontroller",level:2},{value:"8. Audio Output Stage \u2014 The Core Circuit",id:"8-audio-output-stage--the-core-circuit",level:2},{value:"8.1 PWM Generation",id:"81-pwm-generation",level:3},{value:"8.2 Transistor Driver",id:"82-transistor-driver",level:3},{value:"8.3 Inductive Load &amp; Protection",id:"83-inductive-load--protection",level:3},{value:"8.4 The Load: Speaker",id:"84-the-load-speaker",level:3},{value:"9. User Interface Hardware",id:"9-user-interface-hardware",level:2},{value:"9.1 Display",id:"91-display",level:3},{value:"9.2 Analog Input Controls",id:"92-analog-input-controls",level:3},{value:"9.3 Rotary Encoder",id:"93-rotary-encoder",level:3},{value:"10. Pin Assignment Table",id:"10-pin-assignment-table",level:2},{value:"11. Known Hardware Issues",id:"11-known-hardware-issues",level:2},{value:"12. What&#39;s NOT Here",id:"12-whats-not-here",level:2},{value:"Audio",id:"audio",level:3},{value:"Power",id:"power",level:3},{value:"Controls",id:"controls",level:3},{value:"13. Next: v4.0 Hardware Upgrade",id:"13-next-v40-hardware-upgrade",level:2},{value:"14. Related Documentation",id:"14-related-documentation",level:2},{value:"Closing",id:"closing",level:2}];function h(s){const e={a:"a",annotation:"annotation",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...s.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"hardware-design--v38",children:"Hardware Design \u2014 v3.8"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Technical documentation of the current hardware implementation."}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"1-what-this-page-documents",children:"1. What This Page Documents"}),"\n",(0,r.jsxs)(e.p,{children:["This page describes the ",(0,r.jsx)(e.strong,{children:"v3.8 hardware implementation"})," as it exists now \u2014 not as planned, not idealized."]}),"\n",(0,r.jsx)(e.p,{children:"This is a deliberately simple design. The goal is not high-fidelity audio. The goal is understanding transistor switching, inductive loads, and PWM-based signal generation before introducing DACs and abstraction layers."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"2-design-philosophy-low-level-physics-first",children:"2. Design Philosophy: Low-Level Physics First"}),"\n",(0,r.jsx)(e.p,{children:"Before building a system with I2S DACs and op-amp output stages, I wanted to understand:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"How transistors switch inductive loads"}),"\n",(0,r.jsx)(e.li,{children:"What happens when a GPIO pin drives a load that draws too much current"}),"\n",(0,r.jsx)(e.li,{children:"Why inductors generate voltage spikes when current is interrupted"}),"\n",(0,r.jsx)(e.li,{children:"How PWM generates audio, and why it is fundamentally limited"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"v3.8 is intentionally primitive."})}),"\n",(0,r.jsx)(e.p,{children:"The audio quality is ~8-bit equivalent. There is no reconstruction filter. There is no op-amp buffer."}),"\n",(0,r.jsx)(e.p,{children:"These are not oversights \u2014 they are pedagogical choices."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"3-system-overview",children:"3. System Overview"}),"\n",(0,r.jsx)(e.p,{children:"The signal flow in v3.8:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"ESP32-S3 \u2192 PWM (GPIO 16) \u2192 2N2222 Transistor \u2192 8\u03a9 Speaker\r\n    \u2191\r\nPots (ADC) + Encoder (Interrupt) + OLED (I2C)\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Power:"})," 5V USB \u2192 ESP32 onboard 3.3V regulator \u2192 logic and peripherals",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Audio:"})," PWM output \u2192 transistor driver \u2192 speaker (direct, no filter)",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"UI:"})," OLED display + rotary encoder + 2\xd7 potentiometers"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"4-the-complete-schematic",children:"4. The Complete Schematic"}),"\n",(0,r.jsx)(e.p,{children:"Below is the full schematic for v3.8."}),"\n",(0,r.jsx)(e.p,{children:"Let's break down each section."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"5-how-to-read-the-schematic",children:"5. How to Read the Schematic"}),"\n",(0,r.jsx)(e.p,{children:"The circuit is organized into functional blocks:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Power input"})," \u2014 USB 5V input and onboard 3.3V regulation"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"MCU"})," \u2014 ESP32-S3 with all GPIO assignments"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Audio output"})," \u2014 PWM \u2192 transistor \u2192 speaker with flyback diode"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"User interface"})," \u2014 OLED, rotary encoder, potentiometers"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Start from the power rail, follow the signal through the MCU, then trace the audio output path."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"6-power-supply",children:"6. Power Supply"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Rail"}),(0,r.jsx)(e.th,{children:"Voltage"}),(0,r.jsx)(e.th,{children:"Source"}),(0,r.jsx)(e.th,{children:"Load"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"USB Input"}),(0,r.jsx)(e.td,{children:"5V"}),(0,r.jsx)(e.td,{children:"USB-C"}),(0,r.jsx)(e.td,{children:"ESP32 dev board"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Logic Rail"}),(0,r.jsx)(e.td,{children:"3.3V"}),(0,r.jsx)(e.td,{children:"ESP32 onboard LDO"}),(0,r.jsx)(e.td,{children:"MCU, OLED, encoder pull-ups"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Speaker Drive"}),(0,r.jsx)(e.td,{children:"5V (switched)"}),(0,r.jsx)(e.td,{children:"Transistor collector"}),(0,r.jsx)(e.td,{children:"8\u03a9 speaker"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Notes:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"The ESP32 development board includes its own 3.3V LDO regulator"}),"\n",(0,r.jsx)(e.li,{children:"No separate analog power rail (not required for PWM output)"}),"\n",(0,r.jsx)(e.li,{children:"Ground is shared across all subsystems"}),"\n",(0,r.jsx)(e.li,{children:"Decoupling capacitors are present on the ESP32 dev board itself"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"What's NOT here:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"No external LDO regulators"}),"\n",(0,r.jsx)(e.li,{children:"No split analog/digital ground planes"}),"\n",(0,r.jsx)(e.li,{children:"No \xb112V rails (planned for v4.0)"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"7-the-microcontroller",children:"7. The Microcontroller"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Part:"})," ESP32-S3-N16R8 (DevKitC development board)"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Key Specifications:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Dual-core Xtensa LX7 @ 240 MHz"}),"\n",(0,r.jsx)(e.li,{children:"16 MB Flash, 8 MB PSRAM"}),"\n",(0,r.jsx)(e.li,{children:"LEDC peripheral for hardware PWM generation"}),"\n",(0,r.jsx)(e.li,{children:"Built-in I2C, SPI, ADC peripherals"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why ESP32-S3?"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Low cost and widely available"}),"\n",(0,r.jsx)(e.li,{children:"Dual-core architecture (UI and audio can be separated conceptually)"}),"\n",(0,r.jsx)(e.li,{children:"Hardware PWM generation without heavy CPU load"}),"\n",(0,r.jsx)(e.li,{children:"Strong ecosystem and documentation"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"v3.8 does not exploit the dual-core architecture fully \u2014 this is intentional."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"What's NOT here:"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Teensy 4.1 (planned for v4.0)"}),"\n",(0,r.jsx)(e.li,{children:"Custom PCB (v3.8 is breadboard-based)"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"8-audio-output-stage--the-core-circuit",children:"8. Audio Output Stage \u2014 The Core Circuit"}),"\n",(0,r.jsx)(e.p,{children:"This is where digital PWM becomes audible sound."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"81-pwm-generation",children:"8.1 PWM Generation"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Source:"})," ESP32 LEDC peripheral",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Output pin:"})," GPIO 16",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Signal type:"})," Pulse Width Modulation (PWM)"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Important:"})," This is ",(0,r.jsx)(e.strong,{children:"not"})," a DAC.",(0,r.jsx)(e.br,{}),"\n","v3.8 does not use any DAC functionality \u2014 the audio signal is generated purely via PWM."]}),"\n",(0,r.jsx)(e.p,{children:"PWM audio works by varying the duty cycle of a fixed-frequency square wave:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"0% duty cycle \u2192 minimum average voltage"}),"\n",(0,r.jsx)(e.li,{children:"50% duty cycle \u2192 mid-level signal"}),"\n",(0,r.jsx)(e.li,{children:"100% duty cycle \u2192 maximum average voltage"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"The speaker's inductance and mechanical inertia together act as a crude low-pass filtering mechanism, converting the high-frequency switching waveform into audible sound."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why PWM instead of a proper DAC?"})}),"\n",(0,r.jsx)(e.p,{children:"Because PWM exposes:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Duty cycle effects on perceived timbre"}),"\n",(0,r.jsx)(e.li,{children:"Resolution limits (~8-bit effective)"}),"\n",(0,r.jsx)(e.li,{children:"Filtering requirements"}),"\n",(0,r.jsx)(e.li,{children:"Why dedicated DACs exist in real audio systems"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["This limitation is ",(0,r.jsx)(e.strong,{children:"intentional"}),"."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"82-transistor-driver",children:"8.2 Transistor Driver"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Part:"})," 2N2222A NPN transistor",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Configuration:"})," Common-emitter switch",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Base resistor:"})," 1 k\u03a9"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why a transistor?"})}),"\n",(0,r.jsxs)(e.p,{children:["ESP32 GPIO pins are not designed to drive high-current loads directly.",(0,r.jsx)(e.br,{}),"\n","While absolute maximum ratings may approach ~40 mA, safe operating current is significantly lower."]}),"\n",(0,r.jsx)(e.p,{children:"The 8\u03a9 speaker can draw far more current than a GPIO can safely supply. Driving it directly would:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"Cause voltage sag (measured: 3.3V \u2192 ~1.5V)"}),"\n",(0,r.jsx)(e.li,{children:"Risk permanent MCU damage"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"The 2N2222 acts as a current amplifier:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"GPIO supplies ~3 mA base current"}),"\n",(0,r.jsx)(e.li,{children:"Transistor switches ~200 mA collector current"}),"\n",(0,r.jsx)(e.li,{children:"The speaker load is electrically isolated from the MCU"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Base resistor calculation:"})}),"\n",(0,r.jsx)(e.span,{className:"katex-display",children:(0,r.jsxs)(e.span,{className:"katex",children:[(0,r.jsx)(e.span,{className:"katex-mathml",children:(0,r.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(e.semantics,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"R"}),(0,r.jsx)(e.mo,{children:"="}),(0,r.jsxs)(e.mfrac,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsxs)(e.msub,{children:[(0,r.jsx)(e.mi,{children:"V"}),(0,r.jsx)(e.mtext,{children:"GPIO"})]}),(0,r.jsx)(e.mo,{children:"\u2212"}),(0,r.jsxs)(e.msub,{children:[(0,r.jsx)(e.mi,{children:"V"}),(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"B"}),(0,r.jsx)(e.mi,{children:"E"})]})]})]}),(0,r.jsxs)(e.msub,{children:[(0,r.jsx)(e.mi,{children:"I"}),(0,r.jsx)(e.mtext,{children:"base"})]})]})]}),(0,r.jsx)(e.annotation,{encoding:"application/x-tex",children:"R = \\frac{V_{\\text{GPIO}} - V_{BE}}{I_{\\text{base}}}"})]})})}),(0,r.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(e.span,{className:"mrel",children:"="}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"2.1963em",verticalAlign:"-0.836em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(e.span,{className:"mfrac",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,r.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(e.span,{className:"mord",children:(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"I"}),(0,r.jsx)(e.span,{className:"msupsub",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,r.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0785em",marginRight:"0.05em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(e.span,{className:"mord mtight",children:(0,r.jsx)(e.span,{className:"mord text mtight",children:(0,r.jsx)(e.span,{className:"mord mtight",children:"base"})})})})]})}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(e.span,{})})})]})})]})})]}),(0,r.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,r.jsx)(e.span,{className:"msupsub",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,r.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(e.span,{className:"mord mtight",children:(0,r.jsx)(e.span,{className:"mord text mtight",children:(0,r.jsx)(e.span,{className:"mord mtight",children:"GPIO"})})})})]})}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(e.span,{})})})]})})]}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,r.jsx)(e.span,{className:"msupsub",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,r.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,r.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,r.jsx)(e.span,{className:"mord mtight",children:(0,r.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"BE"})})})]})}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,r.jsx)(e.span,{})})})]})})]})]})]})]}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.836em"},children:(0,r.jsx)(e.span,{})})})]})}),(0,r.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,r.jsx)(e.span,{className:"katex-display",children:(0,r.jsxs)(e.span,{className:"katex",children:[(0,r.jsx)(e.span,{className:"katex-mathml",children:(0,r.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(e.semantics,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"R"}),(0,r.jsx)(e.mo,{children:"="}),(0,r.jsxs)(e.mfrac,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mn,{children:"3.3"}),(0,r.jsx)(e.mo,{children:"\u2212"}),(0,r.jsx)(e.mn,{children:"0.7"})]}),(0,r.jsx)(e.mn,{children:"0.003"})]}),(0,r.jsx)(e.mo,{children:"\u2248"}),(0,r.jsx)(e.mn,{children:"867"}),(0,r.jsx)(e.mtext,{children:"\u2009"}),(0,r.jsx)(e.mi,{mathvariant:"normal",children:"\u03a9"})]}),(0,r.jsx)(e.annotation,{encoding:"application/x-tex",children:"R = \\frac{3.3 - 0.7}{0.003} \\approx 867 \\, \\Omega"})]})})}),(0,r.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(e.span,{className:"mrel",children:"="}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(e.span,{className:"mfrac",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,r.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(e.span,{className:"mord",children:(0,r.jsx)(e.span,{className:"mord",children:"0.003"})})]}),(0,r.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord",children:"3.3"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(e.span,{className:"mord",children:"0.7"})]})]})]}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,r.jsx)(e.span,{})})})]})}),(0,r.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(e.span,{className:"mrel",children:"\u2248"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(e.span,{className:"mord",children:"867"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.jsx)(e.span,{className:"mord",children:"\u03a9"})]})]})]})}),"\n",(0,r.jsxs)(e.p,{children:["Nearest standard value: ",(0,r.jsx)(e.strong,{children:"1 k\u03a9"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"83-inductive-load--protection",children:"8.3 Inductive Load & Protection"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"The problem:"})," A speaker voice coil is an ",(0,r.jsx)(e.strong,{children:"inductor"}),"."]}),"\n",(0,r.jsx)(e.p,{children:"When the transistor switches off, the current through the inductor cannot stop instantly. The inductor resists the change, generating a reverse voltage spike:"}),"\n",(0,r.jsx)(e.span,{className:"katex-display",children:(0,r.jsxs)(e.span,{className:"katex",children:[(0,r.jsx)(e.span,{className:"katex-mathml",children:(0,r.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,r.jsxs)(e.semantics,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"V"}),(0,r.jsx)(e.mo,{children:"="}),(0,r.jsx)(e.mo,{children:"\u2212"}),(0,r.jsx)(e.mi,{children:"L"}),(0,r.jsx)(e.mo,{children:"\u22c5"}),(0,r.jsxs)(e.mfrac,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"d"}),(0,r.jsx)(e.mi,{children:"i"})]}),(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"d"}),(0,r.jsx)(e.mi,{children:"t"})]})]})]}),(0,r.jsx)(e.annotation,{encoding:"application/x-tex",children:"V = -L \\cdot \\frac{di}{dt}"})]})})}),(0,r.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(e.span,{className:"mrel",children:"="}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,r.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,r.jsx)(e.span,{className:"mord mathnormal",children:"L"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,r.jsx)(e.span,{className:"mfrac",children:(0,r.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,r.jsxs)(e.span,{className:"vlist-r",children:[(0,r.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,r.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]}),(0,r.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,r.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,r.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,r.jsxs)(e.span,{className:"mord",children:[(0,r.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,r.jsx)(e.span,{className:"mord mathnormal",children:"i"})]})]})]}),(0,r.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,r.jsx)(e.span,{className:"vlist-r",children:(0,r.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,r.jsx)(e.span,{})})})]})}),(0,r.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,r.jsxs)(e.p,{children:["Measured spike: approximately ",(0,r.jsx)(e.strong,{children:"\u2212400 mV"})," below ground (oscilloscope verified)."]}),"\n",(0,r.jsx)(e.p,{children:"This exceeds safe GPIO limits and could damage the MCU."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"The solution:"})," A 1N4007 flyback diode"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Connected anti-parallel to the speaker",(0,r.jsx)(e.br,{}),"\n","(cathode to +5V, anode to transistor collector)"]}),"\n",(0,r.jsx)(e.li,{children:"When the transistor turns off, the diode conducts"}),"\n",(0,r.jsx)(e.li,{children:"Stored energy dissipates safely"}),"\n",(0,r.jsx)(e.li,{children:"Voltage is clamped to approximately \u22120.7 V"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Read more:"}),(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.a,{href:"/blog/inductive-kickback-analysis",children:"Saved by Physics: Analyzing Inductive Kickback"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"84-the-load-speaker",children:"8.4 The Load: Speaker"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Part:"})," 8\u03a9 passive speaker (replaced the original piezo buzzer)"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why a speaker instead of a buzzer?"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Buzzers have fixed resonance and limited frequency response"}),"\n",(0,r.jsx)(e.li,{children:"Speakers reveal frequency response, distortion, and noise clearly"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Volume control:"})," Series potentiometer (P3)"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Known issue:"})," This creates an impedance mismatch. Volume control is non-linear and affects tone quality."]}),"\n",(0,r.jsx)(e.p,{children:"This will be replaced by a proper op-amp attenuator in v4.0."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"9-user-interface-hardware",children:"9. User Interface Hardware"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"91-display",children:"9.1 Display"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Part:"}),' 0.91" OLED (SSD1306)',(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Resolution:"})," 128\xd732",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Interface:"})," I2C (SDA: GPIO 4, SCL: GPIO 5)",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Address:"})," 0x3C"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why I2C?"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Only two signal lines"}),"\n",(0,r.jsx)(e.li,{children:"Simple protocol"}),"\n",(0,r.jsx)(e.li,{children:"Broad library support"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"The OLED displays waveform mode, frequency, and menu feedback."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"92-analog-input-controls",children:"9.2 Analog Input Controls"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Parts:"})," 2\xd7 RV09 10 k\u03a9 linear potentiometers"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Pot"}),(0,r.jsx)(e.th,{children:"GPIO"}),(0,r.jsx)(e.th,{children:"Function"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"P1"}),(0,r.jsx)(e.td,{children:"GPIO 1 (ADC)"}),(0,r.jsx)(e.td,{children:"Pitch control"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"P2"}),(0,r.jsx)(e.td,{children:"GPIO 2 (ADC)"}),(0,r.jsx)(e.td,{children:"Duty cycle / waveform shape"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why analog potentiometers?"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Direct tactile control"}),"\n",(0,r.jsx)(e.li,{children:"No debouncing required"}),"\n",(0,r.jsx)(e.li,{children:"Exposes ADC noise as a learning opportunity"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"ADC noise issue:"})}),"\n",(0,r.jsx)(e.p,{children:"Raw ADC readings showed \xb150 LSB jitter, causing audible instability."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Mitigation (software):"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Exponential Moving Average (",(0,r.jsxs)(e.span,{className:"katex",children:[(0,r.jsx)(e.span,{className:"katex-mathml",children:(0,r.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,r.jsxs)(e.semantics,{children:[(0,r.jsxs)(e.mrow,{children:[(0,r.jsx)(e.mi,{children:"\u03b1"}),(0,r.jsx)(e.mo,{children:"="}),(0,r.jsx)(e.mn,{children:"0.15"})]}),(0,r.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\alpha = 0.15"})]})})}),(0,r.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,r.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.0037em"},children:"\u03b1"}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.jsx)(e.span,{className:"mrel",children:"="}),(0,r.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,r.jsxs)(e.span,{className:"base",children:[(0,r.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,r.jsx)(e.span,{className:"mord",children:"0.15"})]})]})]}),")"]}),"\n",(0,r.jsx)(e.li,{children:"Hysteresis threshold (40 LSB)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Responsiveness is intentionally traded for stability."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"93-rotary-encoder",children:"9.3 Rotary Encoder"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Part:"})," HW-040 (EC11-based)",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Pins:"})," CLK (GPIO 6), DT (GPIO 7), SW (GPIO 15)",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Method:"})," Interrupt-driven (DT falling edge)"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Why interrupts?"})}),"\n",(0,r.jsx)(e.p,{children:"Polling can miss steps during other processing. Interrupts guarantee detection."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Known issue:"})," Low mechanical quality causes missed or false steps."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Planned fix:"})," Replace with higher-quality encoder in future revisions."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"10-pin-assignment-table",children:"10. Pin Assignment Table"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"GPIO"}),(0,r.jsx)(e.th,{children:"Function"}),(0,r.jsx)(e.th,{children:"Component"}),(0,r.jsx)(e.th,{children:"Direction"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"ADC"}),(0,r.jsx)(e.td,{children:"Potentiometer (Pitch)"}),(0,r.jsx)(e.td,{children:"Input"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"ADC"}),(0,r.jsx)(e.td,{children:"Potentiometer (Duty)"}),(0,r.jsx)(e.td,{children:"Input"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"I2C SDA"}),(0,r.jsx)(e.td,{children:"OLED Display"}),(0,r.jsx)(e.td,{children:"Bidirectional"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"I2C SCL"}),(0,r.jsx)(e.td,{children:"OLED Display"}),(0,r.jsx)(e.td,{children:"Output"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"Encoder CLK"}),(0,r.jsx)(e.td,{children:"Rotary Encoder"}),(0,r.jsx)(e.td,{children:"Input"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"7"}),(0,r.jsx)(e.td,{children:"Encoder DT"}),(0,r.jsx)(e.td,{children:"Rotary Encoder"}),(0,r.jsx)(e.td,{children:"Input (interrupt)"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"15"}),(0,r.jsx)(e.td,{children:"Encoder SW"}),(0,r.jsx)(e.td,{children:"Encoder Button"}),(0,r.jsx)(e.td,{children:"Input"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"16"}),(0,r.jsx)(e.td,{children:"PWM"}),(0,r.jsx)(e.td,{children:"Audio Output"}),(0,r.jsx)(e.td,{children:"Output"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"11-known-hardware-issues",children:"11. Known Hardware Issues"}),"\n",(0,r.jsx)(e.p,{children:"These are not bugs \u2014 they are documented learning points:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Issue"}),(0,r.jsx)(e.th,{children:"Cause"}),(0,r.jsx)(e.th,{children:"Impact"}),(0,r.jsx)(e.th,{children:"Planned Fix"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Pitch quantization"}),(0,r.jsx)(e.td,{children:"Aggressive hysteresis"}),(0,r.jsx)(e.td,{children:"~15 Hz minimum step"}),(0,r.jsx)(e.td,{children:"Reduce threshold or use DAC"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Encoder quality"}),(0,r.jsx)(e.td,{children:"Low mechanical tolerance"}),(0,r.jsx)(e.td,{children:"Missed steps"}),(0,r.jsx)(e.td,{children:"Higher-quality encoder"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Volume non-linearity"}),(0,r.jsx)(e.td,{children:"Series pot impedance mismatch"}),(0,r.jsx)(e.td,{children:"Tone affected"}),(0,r.jsx)(e.td,{children:"Op-amp attenuator"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Power rail noise"}),(0,r.jsx)(e.td,{children:"Shared supply"}),(0,r.jsx)(e.td,{children:"Audible hiss"}),(0,r.jsx)(e.td,{children:"Filtering in v4.0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Lo-fi audio"}),(0,r.jsx)(e.td,{children:"PWM resolution"}),(0,r.jsx)(e.td,{children:"~8-bit quality"}),(0,r.jsx)(e.td,{children:"I2S DAC in v4.0"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"These limitations are intentionally tolerated in v3.8 due to the absence of a true analog signal path."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"12-whats-not-here",children:"12. What's NOT Here"}),"\n",(0,r.jsxs)(e.p,{children:["To be explicit, v3.8 does ",(0,r.jsx)(e.strong,{children:"not"})," include:"]}),"\n",(0,r.jsx)(e.h3,{id:"audio",children:"Audio"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274c DAC"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Reconstruction filter"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Op-amp buffer"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Line-level output jack"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"power",children:"Power"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274c External regulators"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Split analog/digital rails"}),"\n",(0,r.jsx)(e.li,{children:"\u274c \xb112V supply"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"controls",children:"Controls"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274c Multiple encoders"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Faders"}),"\n",(0,r.jsx)(e.li,{children:"\u274c VU meters"}),"\n",(0,r.jsx)(e.li,{children:"\u274c Additional displays"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"These will be introduced gradually starting in v4.0."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"13-next-v40-hardware-upgrade",children:"13. Next: v4.0 Hardware Upgrade"}),"\n",(0,r.jsxs)(e.p,{children:["The next iteration focuses on ",(0,r.jsx)(e.strong,{children:"signal integrity"}),", not features."]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Subsystem"}),(0,r.jsx)(e.th,{children:"v3.8"}),(0,r.jsx)(e.th,{children:"v4.0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Audio protocol"}),(0,r.jsx)(e.td,{children:"PWM"}),(0,r.jsx)(e.td,{children:"I2S"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Output stage"}),(0,r.jsx)(e.td,{children:"Transistor \u2192 Speaker"}),(0,r.jsx)(e.td,{children:"DAC \u2192 Op-amp"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"DAC"}),(0,r.jsx)(e.td,{children:"None"}),(0,r.jsx)(e.td,{children:"PCM5102A"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Audio quality"}),(0,r.jsx)(e.td,{children:"~8-bit"}),(0,r.jsx)(e.td,{children:"16-bit / 44.1 kHz"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Status:"})," Components ordered.",(0,r.jsx)(e.br,{}),"\n",(0,r.jsx)(e.strong,{children:"Target:"})," ~6 weeks."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"14-related-documentation",children:"14. Related Documentation"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"./software-architecture",children:"Software Architecture"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"./build-guide",children:"Build Guide"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/blog/inductive-kickback-analysis",children:"Inductive Kickback Analysis"})}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"closing",children:"Closing"}),"\n",(0,r.jsx)(e.p,{children:"This hardware design is not impressive by Hi-Fi standards."}),"\n",(0,r.jsx)(e.p,{children:"Its value lies in the engineering lessons it exposes."}),"\n",(0,r.jsx)(e.p,{children:"Every limitation is intentional. Every choice is documented."})]})}function o(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,r.jsx)(e,{...s,children:(0,r.jsx)(h,{...s})}):h(s)}},8453(s,e,n){n.d(e,{R:()=>a,x:()=>t});var i=n(6540);const r={},l=i.createContext(r);function a(s){const e=i.useContext(l);return i.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function t(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(r):s.components||r:a(s.components),i.createElement(l.Provider,{value:e},s.children)}}}]);